<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-key="page_title">Chinsan New Year Party 2026</title>
    <link href="vendor/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="bg-light">

    <div class="container my-5">
        <div class="card shadow-sm p-4 p-md-5 mx-auto" style="max-width: 500px;" id="main-card">

            <div class="image">
                <img src="" alt="">
            </div>

            <div class="language-switcher">
                <button id="lang-th-btn" class="btn btn-sm lang-btn active" data-lang="th">ไทย</button>
                <button id="lang-en-btn" class="btn btn-sm lang-btn" data-lang="en">Eng</button>
            </div>
            
            <div id="role-selection-section">
                <h1 class="h3 mb-4 fw-bold text-center" data-key="role_selection_title">กรุณาเลือกบทบาทของคุณ</h1>
                <div class="d-grid gap-3">
                    <button id="select-employee-btn" class="btn btn-primary btn-lg" data-key="employee_button">พนักงาน (งานปีใหม่)</button>
                    <button id="select-sportday-btn" class="btn btn-success btn-lg" data-key="sportday_button">ลงทะเบียนกีฬาสี</button>
                    
                    <button id="select-admin-btn" class="btn btn-secondary btn-lg">Admin</button>
                </div>
            </div>

            <div id="app-sections" class="d-none">
                <div id="main-header-container">
                    <h1 class="h3 mb-3 fw-bold text-center" data-key="main_title">Chinsan New Year Party 2026</h1>
                    <p class="text-muted text-center mb-4" data-key="main_subtitle">กรอกข้อมูลเพื่อรับ QR Code สำหรับเข้างาน</p>
                </div>
                <div id="registration-section" class="d-none">
                    <form id="registrationForm">
                        <div class="mb-3"><label for="firstName" class="form-label" data-key="form_firstname">ชื่อจริง</label><input type="text" class="form-control" id="firstName" required></div>
                        <div class="mb-3"><label for="lastName" class="form-label" data-key="form_lastname">นามสกุล</label><input type="text" class="form-control" id="lastName" required></div>
                        <div class="mb-3"><label for="department" class="form-label" data-key="form_department">ฝ่าย</label><input type="text" class="form-control" id="department" required></div>
                        <div class="mb-3"><label for="employeeId" class="form-label" data-key="form_employee_id">รหัสพนักงาน</label><input type="text" class="form-control" id="employeeId" required></div>
                        <div class="d-grid"><button type="submit" class="btn btn-primary btn-lg" data-key="register_button">ลงทะเบียน</button></div>
                    </form>
                    <div class="text-center mt-3"><a href="#" id="showFindFormLink" data-key="forgot_qr_link">ลืม QR Code? / ค้นหา QR Code</a></div>
                    <div id="admin-actions-container" class="mt-4 pt-4 border-top">
                        <div class="row g-3">
                            <div class="col-12 d-grid">
                                <button type="button" id="showAddEmployeeFormBtn" class="btn btn-primary" data-key="add_employee_button">
                                    เพิ่มพนักงาน (กรอกเอง)
                                </button>
                            </div>
                            <div class="col-6 d-grid">
                                <button type="button" id="showCheckinPageBtn" class="btn btn-warning" data-key="checkin_button">เช็คอิน</button>
                            </div>
                            <div class="col-6 d-grid">
                                <button type="button" id="showSportdayPageBtnAdmin" class="btn btn-success" data-key="sportday_admin_button">ลงทะเบียนกีฬาสี</button>
                            </div>
                            <div class="col-6 d-grid">
                                <button type="button" id="viewEmployeesBtn" class="btn btn-info" data-key="view_employees_button">ดูรายชื่อ</button>
                            </div>
                            <div class="col-6 d-grid">
                                <button type="button" id="showFindQrPageBtn" class="btn btn-outline-info" data-key="find_qr_button">ค้นหา QR พนักงาน</button>
                            </div>

                            <div class="col-12"><hr class="my-2"></div>

                            <div class="col-6 d-grid">
                                <button type="button" id="showDrawPageBtn" class="btn btn-success" data-key="draw_prize_button">สุ่มรางวัล</button>
                            </div>
                            <div class="col-6 d-grid">
                                <button type="button" id="managePrizesBtnAdmin" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#managePrizesModal">
                                    จัดการรางวัล
                                </button>
                            </div>

                            <div class="col-12"><hr class="my-2"></div>

                            <div class="col-6 d-grid">
                                <button type="button" id="showVotePageBtn" class="btn btn-danger" data-key="vote_button">โหวต</button>
                            </div>
                            <div class="col-6 d-grid">
                                <button type="button" id="manageVotePeriodBtn" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#manageVotePeriodModal">
                                    ตั้งเวลาโหวต
                                </button>
                            </div>
                            <div class="col-6 d-grid">
                                <button type="button" id="manageCandidatesBtn" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#manageCandidatesModal">
                                    จัดการผู้เข้าประกวด
                                </button>
                            </div>
                            <div class="col-6 d-grid">
                                <button type="button" id="showRealtimeResultsBtn" class="btn btn-outline-primary">
                                    ดูผลโหวต Real-time
                                </button>
                            </div>

                            <div class="col-12"><hr class="my-2"></div>

                            <div class="col-12 d-grid">
                                <button type="button" id="showStatusCheckBtn" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#statusCheckModal" data-key="status_check_button">
                                    สรุปสถานะการเข้าร่วม
                                </button>
                            </div>
                            <div class="col-12 d-grid">
                                <button type="button" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#exportExcelModal" data-key="export_excel_button">Export ข้อมูลเป็น Excel</button>
                            </div>

                        </div>
                        <div class="card bg-light mt-3">
                            <div class="card-body">
                                <h6 class="card-title">อัปโหลดรายชื่อพนักงาน (Excel)</h6>
                                <form id="uploadEmployeeForm">
                                    <div class="mb-2">
                                        <input class="form-control" type="file" id="employeeFile" accept=".xlsx, .xls" required>
                                    </div>
                                    <button type="submit" class="btn btn-warning w-100">อัปโหลดข้อมูล</button>
                                    <small class="text-muted d-block mt-1">
                                        รูปแบบ: A=ชื่อ, B=นามสกุล, C=ฝ่าย, D=รหัสพนักงาน (แถวแรกคือหัวข้อ)
                                    </small>
                                </form>
                            </div>
                        </div>
                        </div>
                </div>

                <div id="find-section" class="d-none">
                    <div class="d-grid mb-3">
                        <button type="button" id="backFromFindBtn" class="btn btn-secondary" data-key="back_to_admin_menu">กลับไปหน้า Admin</button>
                    </div>
                    <form id="findForm">
                        <div class="mb-3"><label for="findEmployeeId" class="form-label" data-key="form_employee_id">รหัสพนักงาน</label><input type="text" class="form-control" id="findEmployeeId" required></div>
                        <div class="d-grid"><button type="submit" class="btn btn-primary btn-lg" data-key="search_button">ค้นหา</button></div>
                    </form>
                    <div class="text-center mt-3"><a href="#" id="showRegisterFormLink" data-key="back_to_register_link" class="d-none">กลับไปหน้าลงทะเบียน</a></div>
                </div>
                
                <div id="result" class="text-center d-none">
                    <h2 id="resultMessage" class="h4 text-success"></h2>
                    <div id="qrCodeContainer" class="my-3"></div>
                    <p class="text-muted" data-key="save_qr_instruction">กรุณาบันทึก QR Code นี้ไว้สำหรับสแกนเข้างาน</p>
                    <div class="d-grid gap-2">
                        <button type="button" id="saveQrBtn" class="btn btn-success" data-key="save_qr_button">บันทึก QR Code</button>
                        <button type="button" id="backToFormBtn" class="btn btn-secondary" data-key="back_to_main_button">กลับไปหน้าหลัก</button>
                    </div>
                </div>

                <div id="sportday-section" class="d-none">
                    <h1 class="h3 mb-3 fw-bold text-center" data-key="sportday_title">ลงทะเบียนกีฬาสี</h1>
                    <p class="text-muted text-center mb-4" data-key="sportday_subtitle">กรอกรหัสพนักงานเพื่อยืนยันการเข้าร่วม</p>
                    <form id="sportdayForm">
                        <div class="mb-3">
                            <label for="sportdayEmployeeId" class="form-label" data-key="form_employee_id">รหัสพนักงาน</label>
                            <input type="text" class="form-control" id="sportdayEmployeeId" required>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-success btn-lg" data-key="sportday_register_button">ยืนยันเข้าร่วม</button>
                        </div>
                    </form>
                    <div id="sportdayResultContainer" class="d-none mt-4"></div>
                    
                    <div class="text-center mt-3">
                        <button type="button" id="backFromSportdayBtn" class="btn btn-secondary" data-key="back_to_role_selection">กลับไปหน้าหลัก</button>
                    </div>
                </div>
                
                <div id="employee-list-section" class="d-none">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <button type="button" id="backFromListBtn" class="btn btn-secondary" data-key="back_to_main_button">กลับไปหน้าหลัก</button>
                        <button type="button" id="deleteAllEmployeesBtn" class="btn btn-danger">ลบข้อมูลทั้งหมด</button>
                    </div>
                    <div class="d-flex justify-content-between align-items-center"><h1 class="h3 mb-0 fw-bold" data-key="employee_list_title">รายชื่อผู้ลงทะเบียน</h1><span id="employee-count-badge" class="badge bg-secondary rounded-pill"></span></div>
                    <div class="input-group my-3">
                        <input type="text" id="employeeSearchInput" class="form-control" placeholder="ค้นหาด้วยชื่อ, นามสกุล, รหัสพนักงาน, หรือฝ่าย...">
                    </div>
                    <div id="employeeTableContainer" class="table-responsive mt-3"></div>
                </div>
                <div id="draw-section" class="d-none text-center">
                    <div class="d-grid mb-3"><button type="button" id="backFromDrawBtn" class="btn btn-secondary" data-key="back_to_main_button">กลับไปหน้าหลัก</button></div>
                    <div id="draw-setup">
                        <h1 class="h3 mb-3 fw-bold" data-key="draw_title">จับรางวัลผู้โชคดี</h1>
                        <div class="row mb-3">
                            
                        </div>
                        <div class="card mb-4">
                            <div class="card-body">
                                <h5 class="card-title" data-key="prize_list_title">รายการของรางวัล</h5>
                                <ol class="list-group list-group-flush list-group-numbered" reversed id="prize-display-list">
                                </ol>
                            </div>
                        </div>
                        <div class="d-grid gap-2">
                             <button type="button" id="startDrawBtn" class="btn btn-success btn-lg" data-key="start_draw_button">เริ่มการสุ่ม!</button>
                        </div>
                    </div>
                    <div id="draw-animation-area" class="d-none">
                        <div class="mb-3">
                            <p class="mb-1 text-muted" data-key="drawing_for_prize">กำลังสุ่มรางวัล:</p>
                            <h2 id="current-prize-drawing" class="h5 text-danger"></h2>
                        </div>
                        <div class="slot-machine bg-dark text-white rounded p-4 mb-3">
                            <p id="slot-name" class="display-6 fw-bold text-warning" data-key="slot_name_placeholder">ชื่อ-นามสกุล</p>
                            <p id="slot-id" class="text-light" data-key="slot_id_placeholder">รหัสพนักงาน</p>
                        </div>
                        <!---->
                        <div id="draw-controls" class="gap-2">
                            <div class="row g-2 mb-3">
                                <div class="col">
                                    <label for="drawTimeInput" class="form-label" data-key="draw_time_label">เวลาสุ่ม (วินาที)</label>
                                    <input type="number" class="form-control" id="drawTimeInput" value="3" min="1">
                                </div>
                                <div class="col">
                                    <label for="drawCountInput" class="form-label" data-key="draw_count_label">จำนวนรางวัล (รอบนี้)</label>
                                    <input type="number" class="form-control" id="drawCountInput" value="1" min="1">
                                </div>
                            </div>
                            <div class="d-grid gap-2"> 
                                <button type="button" id="drawNextBtn" class="btn btn-success btn-lg" data-key="draw_next_button">สุ่มรางวัล!</button>
                                <button type="button" id="resetDrawBtn" class="btn btn-secondary d-none" data-key="reset_draw_button">เริ่มการสุ่มใหม่</button>
                            </div>
                        </div>
                    </div>
                    <div id="winnersListContainer" class="d-none mt-4 text-start"><h2 class="h4" data-key="winners_list_title">🎉 รายชื่อผู้โชคดี 🎉</h2><ol class="list-group list-group-numbered" reversed id="winnersList"></ol></div>
                </div>
                <div id="checkin-section" class="d-none">
                    <div class="d-grid mb-3"><button type="button" id="backFromCheckinBtn" class="btn btn-secondary" data-key="back_to_main_button">กลับไปหน้าหลัก</button></div>
                    <h1 class="h3 mb-3 fw-bold" data-key="checkin_title">ตรวจสอบผู้เข้าร่วมงาน</h1>
                    <form id="checkinForm"><div class="mb-3"><label for="checkinEmployeeId" class="form-label" data-key="checkin_form_label">กรอกรหัสพนักงาน</label><input type="text" class="form-control" id="checkinEmployeeId" required></div><div class="d-grid"><button type="submit" class="btn btn-primary" data-key="checkin_form_button">ตรวจสอบ</button></div></form>
                    <div id="checkinResultContainer" class="d-none mt-4"></div>
                </div>
                <div id="vote-section" class="d-none">
                    <div class="d-grid mb-3"><button type="button" id="backFromVoteBtn" class="btn btn-secondary" data-key="back_to_main_button">กลับไปหน้าหลัก</button></div>
                    <h1 class="h3 mb-3 fw-bold" data-key="vote_title">โหวตการประกวด</h1>
                    <div id="vote-eligibility-check">
                        <p class="text-muted">กรุณากรอกรหัสพนักงานเพื่อตรวจสอบสิทธิ์การโหวต (ต้องเช็คอินแล้ว)</p>
                        <div class="mb-3">
                            <label for="voteEmployeeId" class="form-label" data-key="vote_form_id">รหัสพนักงานของคุณ</label>
                            <input type="text" class="form-control" id="voteEmployeeId" required>
                        </div>
                         <div id="voteEligibilityMessage" class="mb-3 text-danger"></div>
                        <div class="d-grid">
                             <button type="button" id="checkVoteEligibilityBtn" class="btn btn-primary">ตรวจสอบสิทธิ์</button>
                        </div>
                    </div>
                    <div id="vote-main-area" class="d-none">
                        <p id="voteUserMessage" class="text-success mb-3"></p>

                        <div id="vote-countdown-container" class="alert alert-info text-center d-none">
                            <strong data-key="vote_countdown_label">เวลาที่เหลือ:</strong>
                            <h3 id="vote-countdown-timer" class_name="fw-bold mb-0">--:--</h3>
                        </div>

                        <form id="voteForm">
                            <p class="text-muted" data-key="vote_subtitle">เลือกผู้เข้าประกวดที่คุณชื่นชอบ</p>
                            <div id="candidate-list" class="mb-4">
                            </div>
                            <div class="d-grid">
                                <button type="submit" class="btn btn-danger btn-lg" data-key="vote_submit_button">ส่งคะแนนโหวต</button>
                            </div>
                        </form>
                    </div>
                    <hr class="my-4">
                    <div class="d-grid">
                        <button type="button" id="viewVoteResultsBtn" class="btn btn-outline-secondary" data-key="view_vote_results_button">ดูผลโหวตล่าสุด</button>
                    </div>
                    <div id="vote-results-container" class="mt-4 d-none text-start">
                        <h2 class="h4" data-key="vote_results_title">ผลโหวตล่าสุด</h2>
                        <ul id="vote-results-list" class="list-group"></ul>
                    </div>
                </div>
                <div id="realtime-results-section" class="d-none">
                    <div class="d-grid mb-3">
                        <button type="button" id="backFromRealtimeBtn" class="btn btn-secondary" data-key="back_to_main_button">กลับไปหน้าหลัก</button>
                    </div>
                    <h1 class="h3 mb-3 fw-bold text-center">ผลโหวต Real-time (<span id="totalVotes">0</span> คะแนน)</h1>
                    <div id="realtime-candidates-container">
                    </div>
                </div>
                <div id="toast-container" class="toast-container position-fixed bottom-0 end-0 p-3">
                    <div id="successToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true"><div class="toast-header bg-success text-white"><strong class="me-auto">สำเร็จ</strong><button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button></div><div class="toast-body" id="successMessage"></div></div>
                    <div id="errorToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true"><div class="toast-header bg-danger text-white"><strong class="me-auto" data-key="error_title">เกิดข้อผิดพลาด</strong><button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button></div><div class="toast-body" id="errorMessage"></div></div>
                </div>
            </div> </div> </div> <div class="modal fade" id="adminPasswordModal" tabindex="-1" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" data-key="admin_modal_title">สำหรับ Admin</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="adminPasswordForm"><div class="mb-3"><label for="admin-password-input" class="form-label" data-key="admin_modal_password_label">กรุณากรอกรหัสผ่าน</label><input type="password" class="form-control" id="admin-password-input" required></div><div id="admin-password-error" class="text-danger mb-2"></div><button type="submit" class="btn btn-primary w-100" data-key="login_button">เข้าสู่ระบบ</button></form></div></div></div></div>
    <div class="modal fade" id="winnerModal" tabindex="-1" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content text-center"><div class="modal-header bg-success text-white"><h5 class="modal-title w-100" data-key="winner_modal_title">🎉 ขอแสดงความยินดี! 🎉</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div><div class="modal-body p-4"><p class="lead" data-key="winner_modal_subtitle">ผู้โชคดีที่ได้รับรางวัล</p><p id="modal-prize-name" class="h5 text-danger fw-bold"></p><div class="winner-announcement bg-light p-3 rounded mt-3"><p id="modal-winner-name" class="display-6 text-primary fw-bold mb-0"></p><p id="modal-winner-id" class="text-muted"></p></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary w-100" data-bs-dismiss="modal" data-key="close_button">ปิด</button></div></div></div></div>
    <div class="modal fade" id="exportExcelModal" tabindex="-1" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" data-key="export_modal_title">เลือกหัวข้อที่ต้องการ Export</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><p data-key="export_modal_subtitle">กรุณาเลือกข้อมูลที่ต้องการนำออกมาเป็นไฟล์ Excel</p><div class="form-check"><input class="form-check-input" type="checkbox" value="employees" id="export-employees-check" checked><label class="form-check-label" for="export-employees-check" data-key="export_option_employees">รายชื่อผู้ลงทะเบียนทั้งหมด</label></div><div class="form-check"><input class="form-check-input" type="checkbox" value="winners" id="export-winners-check" checked><label class="form-check-label" for="export-winners-check" data-key="export_option_winners">รายชื่อผู้โชคดีที่ได้รับรางวัล</label></div><div class="form-check"><input class="form-check-input" type="checkbox" value="votes" id="export-votes-check" checked><label class="form-check-label" for="export-votes-check" data-key="export_option_votes">ผลคะแนนโหวตการประกวด</label></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-key="cancel_button">ยกเลิก</button><button type="button" id="confirm-export-btn" class="btn btn-success" data-key="confirm_export_button">ยืนยันการ Export</button></div></div></div></div>
    <div class="modal fade" id="managePrizesModal" tabindex="-1" aria-hidden="true"><div class="modal-dialog modal-dialog-centered modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">จัดการรายการรางวัล</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><p class="text-muted">คุณสามารถ เพิ่ม, ลบ, หรือแก้ไขชื่อรางวัลได้ที่นี่ ลำดับรางวัลจะเรียงตามลำดับการเพิ่ม (รางวัลที่ 1 จะอยู่ล่างสุด)</p><ul class="list-group mb-3" id="prize-management-list"></ul><form id="addPrizeForm"><div class="input-group"><input type="text" id="newPrizeNameInput" class="form-control" placeholder="กรอกชื่อรางวัลใหม่" required><button class="btn btn-success" type="submit">เพิ่มรางวัล</button></div></form></div><div class="modal-footer justify-content-between"><button type="button" id="resetPrizesBtn" class="btn btn-danger">รีเซ็ตเป็นค่าเริ่มต้น</button><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button></div></div></div></div>

    <div class="modal fade" id="manageCandidatesModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">จัดการผู้เข้าประกวด</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted">คุณสามารถ เพิ่ม, ลบ, หรือแก้ไขรายชื่อผู้เข้าประกวดได้ที่นี่</p>
                    <ul class="list-group mb-3" id="candidate-management-list"></ul>
                    <form id="addCandidateForm">
                        <div class="input-group">
                            <input type="text" id="newCandidateNameInput" class="form-control" placeholder="ชื่อ-นามสกุล ผู้เข้าประกวด" required>
                            <input type="text" id="newCandidateDeptInput" class="form-control" placeholder="ฝ่าย" required>
                            <button class="btn btn-success" type="submit">เพิ่มผู้เข้าประกวด</button>
                        </div>
                    </form>
                </div>
                <div class="modal-footer justify-content-between">
                    <button type="button" id="resetCandidatesBtn" class="btn btn-danger">รีเซ็ตเป็นค่าเริ่มต้น</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="statusCheckModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" data-key="status_modal_title">สรุปสถานะการเข้าร่วม</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p data-key="status_modal_subtitle">สรุปจำนวนพนักงานที่ดำเนินการในแต่ละขั้นตอน</p>
                    <div id="status-check-loading" class="text-center">
                        <span class="spinner-border spinner-border-sm"></span>
                    </div>
                    <ul id="status-check-list" class="list-group list-group-flush d-none">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span data-key="status_total">พนักงานทั้งหมดในระบบ</span>
                            <span id="status-total" class="badge bg-secondary rounded-pill">0</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span data-key="status_new_year">✔️ ลงทะเบียนปีใหม่ (รับ QR)</span>
                            <span id="status-new-year" class="badge bg-primary rounded-pill">0</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span data-key="status_sport_day">✔️ ลงทะเบียนกีฬาสี</span>
                            <span id="status-sport-day" class="badge bg-success rounded-pill">0</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span data-key="status_checked_in">✔️ เช็คอินเข้างาน</span>
                            <span id="status-checked-in" class="badge bg-warning text-dark rounded-pill">0</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center fw-bold text-danger">
                            <span data-key="status_all_three">⭐ ครบทุกเงื่อนไข (มีสิทธิ์สุ่มรางวัล)</span>
                            <span id="status-all-three" class="badge bg-danger rounded-pill">0</span>
                        </li>
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-key="close_button">ปิด</button>
                </div>
            </div>
        </div>
    </div>

    
    <div class="modal fade" id="manageVotePeriodModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" data-key="vote_manage_title">ตั้งค่าการโหวต</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="vote-status-loading" class="text-center">
                    <span class="spinner-border spinner-border-sm"></span>
                    <span data-key="vote_status_loading">กำลังโหลดสถานะ...</span>
                </div>
                <div id="vote-status-display" class="d-none">
                    <div id="vote-status-closed" class="d-none">
                        <p data-key="vote_status_closed">สถานะ: ปิดโหวต</p>
                        <form id="startVoteForm">
                            <div class="mb-3">
                                <label for="voteDurationInput" class="form-label" data-key="vote_duration_label">ระยะเวลา (นาที)</label>
                                <input type="number" class="form-control" id="voteDurationInput" value="10" min="1" required>
                            </div>
                            <button type="submit" class="btn btn-success w-100" data-key="vote_start_button">เริ่มเปิดโหวต</button>
                        </form>
                    </div>
                    <div id="vote-status-open" class="d-none">
                        <div class="alert alert-success">
                            <strong data-key="vote_status_open">สถานะ: เปิดโหวต</strong>
                            <p id="vote-deadline-display" class="mb-0"></p>
                            <h3 id="admin-vote-countdown" class="fw-bold text-center my-2">--:--</h3>
                        </div>
                        <button type="button" id="closeVoteNowBtn" class="btn btn-danger w-100" data-key="vote_close_button">ปิดโหวตทันที</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

    <script src="vendor/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>